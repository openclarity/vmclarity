package findingKey

import (
	"crypto/sha256"

	"github.com/openclarity/vmclarity/api/models"
)

// GenerateExploitFindingUniqueKey Unique key for an exploit today is SourceDB + CVE ID + the discovering URLs.
func GenerateExploitFindingUniqueKey(exploit models.ExploitFindingInfo) string {
	hash := sha256.New()

	hash.Write([]byte(*exploit.SourceDB))
	hash.Write([]byte(*exploit.CveID))
	for _, url := range *exploit.Urls {
		hash.Write([]byte(url))
	}

	return string(hash.Sum(nil))
}
