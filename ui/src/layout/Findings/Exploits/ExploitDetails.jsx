import React from "react";
import { useLocation } from "react-router-dom";
import TabbedPage from "components/TabbedPage";
import FindingsDetailsPage from "../FindingsDetailsPage";
import TabExploitDetails from "./TabExploitDetails";
import AssetsForFindingTable from "layout/Assets/AssetsForFindingTable";

const EXPLOIT_DETAILS_PATHS = {
  ASSET_LIST: "assets",
};

const DetailsContent = ({ data }) => {
  const { pathname } = useLocation();

  const { id } = data;

  return (
    <TabbedPage
      basePath={`${pathname.substring(0, pathname.indexOf(id))}${id}`}
      items={[
        {
          id: "general",
          title: "Exploit details",
          isIndex: true,
          component: () => <TabExploitDetails data={data} />,
        },
        {
          id: "assets",
          title: "Assets",
          path: EXPLOIT_DETAILS_PATHS.ASSET_LIST,
          component: () => <AssetsForFindingTable findingId={id} />,
        },
      ]}
      withInnerPadding={false}
    />
  );
};

const ExploitDetails = () => (
  <FindingsDetailsPage
    backTitle="Exploits"
    getTitleData={({ findingInfo }) => ({ title: findingInfo.name })}
    detailsContent={DetailsContent}
  />
);

export default ExploitDetails;
