# Configuration

## Orchestrator

| Environment Variable                                                        | Required | Default     | Values                          | Description                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------------------------------------------------------| -------- | ----------- | ------------------------------- |-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `VMCLARITY_ORCHESTRATOR_PROVIDER`                                           | **yes**  | `aws`       | `aws`, `azure`, `gcp`, `docker` | Provider used for _Asset_ discovery and scans.                                                                                                                                                                                                                                                                                                        |
| `VMCLARITY_ORCHESTRATOR_APISERVER_ADDRESS`                                  | **yes**  |             |                                 | The URL for the _API Server_ used by the _Orchestrator_ to interact with the API.  Example: `https://apiserver.example.com:8888/api`                                                                                                                                                                                                                  |
| `VMCLARITY_ORCHESTRATOR_HEALTHCHECK_ADDRESS`                                |          | `:8082`     |                                 | Bind address to used by the _Orchestrator_ for `healthz` endpoint. Example: `localhost:8082` which will make the health endpoints be available at `localhost:8082/healthz/live` and `localhost:8082/healthz/ready`.                                                                                                                                   |
| `VMCLARITY_ORCHESTRATOR_DISCOVERY_INTERVAL`                                 |          | `2m`        |                                 | How frequently the _Discovery_ perform discovery of _Assets_.                                                                                                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_CONTROLLER_STARTUP_DELAY`                           |          | `7s`        |                                 | The time interval to wait between cotroller startups. **Do NOT change this parameter unless you know what you are doing.**                                                                                                                                                                                                                            |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_POLL_PERIOD`                      |          | `15s`       |                                 | How frequently poll the API for events related _AssetScan_ objects.                                                                                                                                                                                                                                                                                   |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_RECONCILE_TIMEOUT`                |          | `5m`        |                                 | Time period for reconciling a _AssetScan_ event is allowed to run.                                                                                                                                                                                                                                                                                    |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_ABORT_TIMEOUT`                    |          | `10m`       |                                 | Time period to wait for the _Scanner_ to gracefully stop on-going scan for _AssetScan_ before setting the state of the AssetScan to `Failed`.                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_DELETE_POLICY`                    |          | `Always`    | `Always`, `Never`, `OnSuccess`  | Whether to delete resources (disk snapshot, container snapshot/images) or not based on the status of the _AssetScan_. `Always` means the _AssetScan_ is deleted no matter if it failed or not. `Never` skip cleaning up the resources created for scanning. `OnSuccess` means that cleanup is happening only iun case the _AssetScan_ was successful. |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`          | **yes**  |             |                                 | The _Scanner_ container image used for running scans.                                                                                                                                                                                                                                                                                                 |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_GITLEAKS_PATH`            |          | `gitleaks`  |                                 | Path to the `gitleaks` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CLAMSCAN_PATH`            |          | `clamscan`  |                                 | Path to the `clamscan` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_FRESHCLAM_PATH`           |          | `freshclam` |                                 | Path to the `freshclam` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                        |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_FRESHCLAM_MIRROR`         |          |             |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_LYNIS_PATH`               |          | `lynis`     |                                 | Path to the `lynis` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                            |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_APISERVER_ADDRESS`        |          |             |                                 | The URL for the _API Server_ used by the _Scanner_ to interact with the API. Example: `https://apiserver.example.com:8888/api`                                                                                                                                                                                                                        |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_EXPLOITSDB_ADDRESS`       |          |             |                                 | The URL for the _ExploitsDB Server_ used by the _Scanner_.                                                                                                                                                                                                                                                                                            |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_TRIVY_SERVER_ADDRESS`     |          |             |                                 | The URL for the _Trivy Server_ used by the _Scanner_.                                                                                                                                                                                                                                                                                                 |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_TRIVY_SERVER_TIMEOUT`     |          | `5m`        |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_GRYPE_SERVER_ADDRESS`     |          |             |                                 | The URL for the _Grype Server_ used by the _Scanner_.                                                                                                                                                                                                                                                                                                 |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_GRYPE_SERVER_TIMEOUT`     |          | `2m`        |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CHKROOTKIT_PATH`          |          | `chkrotkit` |                                 | Path to the `chkrotkit` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                        |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_YARA_PATH`                |          | `yara`      |                                 | Path to the `yara` binary in the _Scanner_ container image defined in `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_CONTAINER_IMAGE`.                                                                                                                                                                                                             |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_WATCHER_SCANNER_YARA_RULE_SERVER_ADDRESS` |          |             |                                 | The URL for the _Yara Rule Server_ used by the _Scanner_.                                                                                                                                                                                                                                                                                             |
| `VMCLARITY_ORCHESTRATOR_SCANCONFIG_WATCHER_POLL_PERIOD`                     |          |             |                                 | How frequently the _ScanConfig Watcher_ poll the API for events related _ScanConfig_ objects.                                                                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_SCANCONFIG_WATCHER_RECONCILE_TIMEOUT`               |          |             |                                 | Time period which a reconciliation for a _ScanConfig_ event is allowed to run.                                                                                                                                                                                                                                                                        |
| `VMCLARITY_ORCHESTRATOR_SCAN_WATCHER_POLL_PERIOD`                           |          |             |                                 | How frequently the _AssetScan Watcher_ poll the API for events related _Scan_ objects.                                                                                                                                                                                                                                                                |
| `VMCLARITY_ORCHESTRATOR_SCAN_WATCHER_RECONCILE_TIMEOUT`                     |          |             |                                 | Time period for reconciling a _Scan_ event is allowed to run.                                                                                                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_SCAN_WATCHER_SCAN_TIMEOUT`                          |          |             |                                 | Time period to wait for the _Scan_  finish before marked it's state as `Failed` with `Timeout` as a reason.                                                                                                                                                                                                                                           |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_PROCESSOR_POLL_PERIOD`                    |          |             |                                 | How frequently the _AssetScan Processor_ poll the API for events related _AssetScan_ objects.                                                                                                                                                                                                                                                         |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_PROCESSOR_RECONCILE_TIMEOUT`              |          |             |                                 | Time period for processing for a _AssetScan_ result is allowed to run.                                                                                                                                                                                                                                                                                |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_ESTIMATION_WATCHER_POLL_PERIOD`           |          | `5s`        |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_ASSETSCAN_ESTIMATION_WATCHER_RECONCILE_TIMEOUT`     |          | `15s`       |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_SCAN_ESTIMATION_WATCHER_POLL_PERIOD`                |          | `5s`        |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_SCAN_ESTIMATION_WATCHER_RECONCILE_TIMEOUT`          |          | `2m`        |                                 |                                                                                                                                                                                                                                                                                                                                                       |
| `VMCLARITY_ORCHESTRATOR_SCAN_ESTIMATION_WATCHER_ESTIMATION_TIMEOUT`         |          | `48h`       |                                 |                                                                                                                                                                                                                                                                                                                                                       |


## Provider

### AWS

| Environment Variable                   | Required | Default      | Description                                                                   |
|----------------------------------------|----------|--------------|-------------------------------------------------------------------------------|
| `VMCLARITY_AWS_REGION`                 | **yes**  |              | Region where the Scanner instance needs to be created                         |
| `VMCLARITY_AWS_SUBNET_ID`              | **yes**  |              | SubnetID where the Scanner instance needs to be created                       |
| `VMCLARITY_AWS_SECURITY_GROUP_ID`      | **yes**  |              | SecurityGroupId which needs to be attached to the Scanner instance            |
| `VMCLARITY_AWS_KEYPAIR_NAME`           |          |              | Name of the SSH KeyPair to use for Scanner instance launch                    |
| `VMCLARITY_AWS_SCANNER_AMI_ID`         | **yes**  |              | The AMI image used for creating Scanner instance                              |
| `VMCLARITY_AWS_SCANNER_INSTANCE_TYPE`  |          | `t2.large`   | The instance type used for Scanner instance                                   |
| `VMCLARITY_AWS_BLOCK_DEVICE_NAME`      |          | `xvdh`       | Block device name used for attaching Scanner volume to the Scanner instance   |
